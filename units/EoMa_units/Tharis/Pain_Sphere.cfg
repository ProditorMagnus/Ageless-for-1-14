#textdomain wesnoth-Era_of_Magic
[unit_type]
    id=AE_mag_Pain_Sphere
    name= _ "Pain Sphere"
    race=mechanical
    image="units/tharis-orbs/orb3b-icon.png"
    hitpoints=43
    movement_type=smallfly
    movement=8
    experience=55
    level=2
    alignment=chaotic
    advances_to=null
    [advancement]
        strict_amla=yes
        max_times=1
        id=painsphere_painchainingII
        description= _ "Pain Chaining now reduces magical resistances too, +1 HP +25% max XP"
        image="attacks/anti-magic.png"
        [effect]
            apply_to=remove_ability
            [abilities]
                {ABILITY_AE_MAG_PAIN_CHAINING}
            [/abilities]
        [/effect]
        [effect]
            apply_to=new_ability
            [abilities]
                {ABILITY_AE_MAG_PAIN_CHAINING2}
            [/abilities]
        [/effect]
        [effect]
            apply_to=hitpoints
            increase_total=1
            heal_full=yes
        [/effect]
        [effect]
            apply_to=max_experience
            increase=25%
        [/effect]
        [effect]
            apply_to=status
            remove=poisoned
        [/effect]
        [effect]
            apply_to=status
            remove=slowed
        [/effect]
    [/advancement]
    [advancement]
        strict_amla=yes
        max_times=1
        id=painsphere_scavenger
        description= _ "Scavenger 3, +3 HP +20% max XP"
        image="attacks/devour.png"
        [effect]
            apply_to=remove_ability
            [abilities]
                {ABILITY_AE_MAG_SCAVENGER 1}
            [/abilities]
        [/effect]
        [effect]
            apply_to=new_ability
            [abilities]
                {ABILITY_AE_MAG_SCAVENGER 3}
            [/abilities]
        [/effect]
        [effect]
            apply_to=hitpoints
            increase_total=3
            heal_full=yes
        [/effect]
        [effect]
            apply_to=max_experience
            increase=20%
        [/effect]
        [effect]
            apply_to=status
            remove=poisoned
        [/effect]
        [effect]
            apply_to=status
            remove=slowed
        [/effect]
    [/advancement]
    [advancement]
        strict_amla=yes
        max_times=1
        id=painsphere_magicdodge
        description= _ "Magic Dodge on blast, +2 HP, +20% max XP"
        image="attacks/anti-magic.png"
        [effect]
            apply_to=attack
            name=blast
            [set_specials]
                mode=append
                {WEAPON_SPECIAL_AE_MAG_MAGIC_DODGE}
            [/set_specials]
        [/effect]
        [effect]
            apply_to=hitpoints
            increase_total=2
            heal_full=yes
        [/effect]
        [effect]
            apply_to=max_experience
            increase=20%
        [/effect]
        [effect]
            apply_to=status
            remove=poisoned
        [/effect]
        [effect]
            apply_to=status
            remove=slowed
        [/effect]
    [/advancement]
    [advancement]
        strict_amla=yes
        max_times=1
        id=painsphere_blast
        description= _ "+1 strike on blast, +3 HP, +20% max XP"
        image="attacks/shockwave-red.png"
        [effect]
            apply_to=attack
            name=blast
            increase_attacks=1
        [/effect]
        [effect]
            apply_to=hitpoints
            increase_total=3
            heal_full=yes
        [/effect]
        [effect]
            apply_to=max_experience
            increase=20%
        [/effect]
        [effect]
            apply_to=status
            remove=poisoned
        [/effect]
        [effect]
            apply_to=status
            remove=slowed
        [/effect]
    [/advancement]
    [advancement]
        strict_amla=yes
        max_times=1
        id=painsphere_resistances
        description= _ "+10% blade/pierce/impact resistance, +3 HP +20% max XP"
        image="icons/protect-red-1.png"
        [effect]
            apply_to=resistance
            [resistance]
                blade=-10
                pierce=-10
                impact=-10
            [/resistance]
        [/effect]
        [effect]
            apply_to=hitpoints
            increase_total=3
            heal_full=yes
        [/effect]
        [effect]
            apply_to=max_experience
            increase=20%
        [/effect]
        [effect]
            apply_to=status
            remove=poisoned
        [/effect]
        [effect]
            apply_to=status
            remove=slowed
        [/effect]
    [/advancement]
    {AMLA_DEFAULT}
    cost=39
    usage=scout
    description={AE_EOMA_UNIT_NOTICE}+{NO_DESCR_AVAILABLE}
    die_sound=silence.ogg

    [defend]
        start_time=-126
        [frame]
            image="units/tharis-orbs/orb3b-icon2.png:252"
            auto_vflip=false
        [/frame]
    [/defend]

    [resistance]
        arcane=130
        blade=80
        cold=80
        fire=80
        pierce=80
        impact=80
    [/resistance]

    [death]
        start_time=0
        [missile_frame]
            halo="projectiles/fireball-impact-[1~16].png~GS()~CS(250,0,0)~SCALE(100,150):60"
            offset=0.0
            sound=magic-dark-big.ogg
            auto_vflip=false
        [/missile_frame]
    [/death]

    [recruit_anim]
        start_time=0
        [frame]
            image="halo/doom-glow.png:100"
            blend_color=0,0,0
            blend_ratio=0.5
            y=20
        [/frame]
        [frame]
            duration=200
            image="halo/doom-glow.png"
            blend_color=0,0,0
            blend_ratio=0.5~0
            y=20~-5
            sound=magic-dark-big.ogg
        [/frame]
    [/recruit_anim]

    [extra_anim]
        flag=pain
        start_time=0
        fx_start_time=0
        [fx_frame]
            duration=200
            halo="halo/shockwave/[01~12].png"
            halo_y=-12
            halo_mod=~NEG()
            sound=magic-dark-big.ogg
        [/fx_frame]
        [shield_frame]
            image="units/tharis-orbs/shield.png:200"
            auto_vflip=false
            layer=1
        [/shield_frame]
        [frame]
            duration=200
            image="halo/doom-glow.png"
            y=-5
            auto_vflip=false
        [/frame]
    [/extra_anim]

#define PAIN_SPHERE_BOLT_ANIM1 NUMBER DURATION
    [bolt_frame]
        image="units/tharis-orbs/energy-a-{NUMBER}.png:75"
        image_mod=~GS()~R(255)
        auto_vflip=false
    [/bolt_frame]
    [bolt_frame]
        image="misc/blank-hex.png:{DURATION}"
    [/bolt_frame]
#enddef

#define PAIN_SPHERE_BOLT_ANIM2 NUMBER DURATION
    [bolt2_frame]
        image="units/tharis-orbs/energy-b-{NUMBER}.png:75"
        image_mod=~GS()~R(255)
        auto_vflip=false
    [/bolt2_frame]
    [bolt2_frame]
        image="misc/blank-hex.png:{DURATION}"
    [/bolt2_frame]
#enddef

    [standing_anim]
        start_time=0
        bolt2_start_time=100
        [shield_frame]
            image="units/tharis-orbs/shield.png:400"
            auto_vflip=false
            layer=1
        [/shield_frame]
        {PAIN_SPHERE_BOLT_ANIM1 1 100}
        {PAIN_SPHERE_BOLT_ANIM1 3 200}
        {PAIN_SPHERE_BOLT_ANIM1 2 60}
        {PAIN_SPHERE_BOLT_ANIM1 4 250}
        {PAIN_SPHERE_BOLT_ANIM1 1 50}
        {PAIN_SPHERE_BOLT_ANIM1 2 150}

        {PAIN_SPHERE_BOLT_ANIM2 2 150}
        {PAIN_SPHERE_BOLT_ANIM2 1 50}
        {PAIN_SPHERE_BOLT_ANIM2 4 250}
        {PAIN_SPHERE_BOLT_ANIM2 2 60}
        {PAIN_SPHERE_BOLT_ANIM2 3 200}
        {PAIN_SPHERE_BOLT_ANIM2 1 100}
        [frame]
            duration=400
            image="halo/doom-glow.png"
            y=-5
        [/frame]
    [/standing_anim]

    [movement_anim]
        start_time=0
        [shield_frame]
            image="units/tharis-orbs/shield.png:200"
            auto_vflip=false
            layer=1
            offset=0.0~1.0
        [/shield_frame]
        [bolt_frame]
            duration=200
            image="units/tharis-orbs/energy-a-[1,2,4,3,1,2].png"
            auto_vflip=false
            image_mod=~GS()~R(255)
            offset=0.0~1.0
        [/bolt_frame]
        [bolt2_frame]
            duration=200
            image="units/tharis-orbs/energy-b-[2,1,3,4,2,1].png"
            auto_vflip=false
            image_mod=~GS()~R(255)
            offset=0.0~1.0
        [/bolt2_frame]
        [frame]
            duration=200
            image="halo/doom-glow.png"
            y=-5
            auto_vflip=false
        [/frame]
    [/movement_anim]

    [abilities]
        {ABILITY_AE_MAG_PAINABSORB 1}
        {ABILITY_AE_MAG_SCAVENGER 1}
        {ABILITY_AE_MAG_PAIN_CHAINING}
    [/abilities]
    [attack]
        name=touch
        description= _ "touch"
        icon=attacks/darkball-destroyers.png
        type=cold
        range=melee
        damage=4
        number=3
        [specials]
            {WEAPON_SPECIAL_MAGICAL}
        [/specials]
    [/attack]
    [attack]
        name=blast
        description= _ "blast"
        icon=attacks/shockwave-red.png
        type=impact
        range=ranged
        damage=6
        number=4
        [specials]
            {WEAPON_SPECIAL_AE_MAG_GREATER_MARKSMAN}
        [/specials]
    [/attack]
    [attack_anim]
        [filter_attack]
            name=touch
        [/filter_attack]
        start_time=-250
        shield_start_time=-250
        bolt_start_time=-250
        bolt2_start_time=-250
        sound_start_time=0
        [shield_frame]
            image="units/tharis-orbs/shield.png:500"
            auto_vflip=false
            layer=1
            offset=0.0~0.8:250,0.8~0.0:250
        [/shield_frame]
        [bolt_frame]
            duration=500
            image="units/tharis-orbs/energy-a-[1,2,4,3,1,2].png"
            auto_vflip=false
            image_mod=~GS()~R(255)
            offset=0.0~0.8:250,0.8~0.0:250
        [/bolt_frame]
        [bolt2_frame]
            duration=500
            image="units/tharis-orbs/energy-b-[2,1,3,4,2,1].png"
            auto_vflip=false
            image_mod=~GS()~R(255)
            offset=0.0~0.8:250,0.8~0.0:250
        [/bolt2_frame]
        [frame]
            duration=500
            image="halo/doom-glow.png"
            y=-5
            auto_vflip=false
            offset=0.0~0.8:250,0.8~0.0:250
        [/frame]

        [sound_frame]
            duration=100
            sound=magic-dark-big-miss.ogg
        [/sound_frame]
    [/attack_anim]

    [attack_anim]
        [filter_attack]
            name=blast
        [/filter_attack]
        start_time=-400
        missile_start_time=0
        [missile_frame]
            duration=250
            halo="halo/shockwave/[01~12].png"
            halo_y=-12
            halo_mod=~NEG()~SCALE_INTO(120)
            offset=0.5
            sound=magic-faeriefire.ogg
        [/missile_frame]
        [shield_frame]
            image="units/tharis-orbs/shield.png:400"
            auto_vflip=false
            layer=1
        [/shield_frame]
        [frame]
            duration=400
            image="halo/doom-glow.png"
            y=-5
            auto_vflip=false
        [/frame]
    [/attack_anim]
[/unit_type]
