#textdomain wesnoth-Harpies

#define ABILITY_HEAL_12
    [heals]
        value=12
        id=healing
        affect_allies=yes
        name= _ "heals +12"
        female_name= _ "female^heals +12"
        description= _ "This unit uses ancient magic to heal units more quickly than is normally possible on the battlefield.

A unit cared for by this healer may heal up to 12 HP per turn, or be cured of poison."
        affect_self=no
        poison=slowed
        [affect_adjacent]
        [/affect_adjacent]
    [/heals]
#enddef

# wmllint: unbalanced-on
# wmlxgettext: [abilities]
#define ABILITY_HARPY_PHOENIX_REVIVEBUFF VALUE
    [leadership]
        id=AE_agl_harpy_phoenix_revived{VALUE}
        add={VALUE}
        name=_"revived"
        description=_"This unit has +"+{VALUE}+_"% damage on all attacks but cannot revive again. Lasts until the end of this scenario."
    [/leadership]
    [dummy]
        id=AE_agl_harpy_phoenix_revivefilter
    [/dummy]
#enddef

#define ABILITY_HARPY_PHOENIX_NOEVENTS VALUE
    [harpy_phoenix]
        id=AE_agl_harpy_phoenix
        name=_ "rise from ashes"
        description=_ "When this unit is killed, they revive with full hitpoints and gain +"+{VALUE}_"% damage for the rest of the scenario. Works once per scenario."
        value={VALUE}
    [/harpy_phoenix]
#enddef

# wmllint: unbalanced-on
# wmlxgettext: [abilities]
#define ABILITY_HARPY_PHOENIX VALUE
    {ABILITY_HARPY_PHOENIX_NOEVENTS {VALUE}}
[/abilities]

[event]
    name=last breath
    first_time_only=no
    id=AE_agl_harpy_phoenix_event
    [filter]
        ability=AE_agl_harpy_phoenix
        [not]
            ability=AE_agl_harpy_phoenix_revivefilter
        [/not]
    [/filter]
    [animate_unit]
        flag=phoenix_anim
        [filter]
            id=$unit.id
        [/filter]
    [/animate_unit]
    [heal_unit]
        [filter]
            id=$unit.id
        [/filter]
        amount=full
        animate=no
        restore_statuses=no
    [/heal_unit]
    [object]
        silent=yes
        duration=scenario
        [filter]
            id=$unit.id
        [/filter]
        [effect]
            apply_to=new_ability
            [abilities]
                {ABILITY_HARPY_PHOENIX_REVIVEBUFF $unit.abilities.harpy_phoenix.value}
            [/abilities]
        [/effect]
    [/object]
[/event]
[+abilities] # wmlxgettext: [/abilities]
#enddef
# wmllint: unbalanced-off
